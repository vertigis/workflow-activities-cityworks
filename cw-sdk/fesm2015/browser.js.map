{"version":3,"file":"browser.js","sources":["../esm2015/api-service/AuthenticationService.js","../esm2015/core/service-types.js","../esm2015/browser/http-service.js","../esm2015/browser/cookie-service.js","../esm2015/browser/api-service.js"],"sourcesContent":["export class AuthenticationService {\r\n    constructor(service) { this._service = service; }\r\n    Authenticate(request) {\r\n        return this._service.call(request, 'General/Authentication/Authenticate');\r\n    }\r\n    CityworksOnlineAuthenticate(request) {\r\n        return this._service.call(request, 'General/Authentication/CityworksOnlineAuthenticate');\r\n    }\r\n    CityworksOnlineSites(request) {\r\n        return this._service.call(request, 'General/Authentication/CityworksOnlineSites');\r\n    }\r\n    Domains(request) {\r\n        return this._service.call(request, 'General/Authentication/Domains');\r\n    }\r\n    User(request) {\r\n        return this._service.call(request, 'General/Authentication/User');\r\n    }\r\n    Validate(request) {\r\n        return this._service.call(request, 'General/Authentication/Validate');\r\n    }\r\n    Version(request) {\r\n        return this._service.call(request, 'General/Authentication/Version');\r\n    }\r\n}\r\n","export var ServiceTypes;\r\n(function (ServiceTypes) {\r\n    let CoreResponseMessageType;\r\n    (function (CoreResponseMessageType) {\r\n        CoreResponseMessageType[CoreResponseMessageType[\"Success\"] = 0] = \"Success\";\r\n        CoreResponseMessageType[CoreResponseMessageType[\"Warning\"] = 1] = \"Warning\";\r\n        CoreResponseMessageType[CoreResponseMessageType[\"Error\"] = 2] = \"Error\";\r\n    })(CoreResponseMessageType = ServiceTypes.CoreResponseMessageType || (ServiceTypes.CoreResponseMessageType = {}));\r\n    let CoreResponseStatus;\r\n    (function (CoreResponseStatus) {\r\n        CoreResponseStatus[CoreResponseStatus[\"Ok\"] = 0] = \"Ok\";\r\n        CoreResponseStatus[CoreResponseStatus[\"Error\"] = 1] = \"Error\";\r\n        CoreResponseStatus[CoreResponseStatus[\"Unauthorized\"] = 2] = \"Unauthorized\";\r\n        CoreResponseStatus[CoreResponseStatus[\"InvalidCredentials\"] = 3] = \"InvalidCredentials\";\r\n        CoreResponseStatus[CoreResponseStatus[\"ConnectionError\"] = -1] = \"ConnectionError\";\r\n    })(CoreResponseStatus = ServiceTypes.CoreResponseStatus || (ServiceTypes.CoreResponseStatus = {}));\r\n})(ServiceTypes || (ServiceTypes = {}));\r\n","function jsonParse(jsonText) {\r\n    //Date format is YYYY-MM-DDThh:mm:ss\r\n    //This is assumed to be local time and is only here for legacy reasons.\r\n    const DATE_REGEX_LOCAL = /(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})$/;\r\n    return JSON.parse(jsonText, function (key, value) {\r\n        let retVal = value;\r\n        const isString = (value) && (typeof value == 'string');\r\n        const isStandardDate = isString && DATE_REGEX_LOCAL.test(value);\r\n        //------------------------------------------------------------\r\n        //  Try to parse dates\r\n        //------------------------------------------------------------\r\n        if (isStandardDate) {\r\n            const result = DATE_REGEX_LOCAL.exec(value);\r\n            if (result) {\r\n                // Get all of the date's components.\r\n                const year = parseInt(result[1]);\r\n                const month = parseInt(result[2]) - 1; // Month is zero based.\r\n                const day = parseInt(result[3]);\r\n                const hour = parseInt(result[4]);\r\n                const min = parseInt(result[5]);\r\n                const sec = parseInt(result[6]);\r\n                //Check for null date\r\n                if (year === 1 && month === 0 && day === 1) {\r\n                    retVal = null;\r\n                }\r\n                else {\r\n                    //Create the date. This is local time and is not correct unless the server\r\n                    //time is the same as local time.\r\n                    const localDate = new Date(year, month, day, hour, min, sec);\r\n                    //MUST set full year to handle cases such as \"0001-01-01\"\r\n                    localDate.setFullYear(year);\r\n                    retVal = localDate;\r\n                }\r\n            }\r\n        }\r\n        return retVal;\r\n    });\r\n}\r\nexport function post(url, token, csrfToken, csrfTokenHeader, dataParams) {\r\n    const xhr = new XMLHttpRequest();\r\n    const promise = new Promise((resolve, reject) => {\r\n        const apiUrl = url;\r\n        let uri = '';\r\n        if (!dataParams)\r\n            dataParams = { data: {}, token: (token !== null ? token : '') };\r\n        else {\r\n            dataParams = { data: JSON.stringify(dataParams), token: (token !== null ? token : '') };\r\n        }\r\n        for (let key in dataParams) {\r\n            uri += encodeURIComponent(key) + '=' + encodeURIComponent(dataParams[key]) + '&';\r\n        }\r\n        xhr.open('POST', apiUrl, true);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        if (csrfTokenHeader && csrfTokenHeader.length > 0 && csrfToken && csrfToken.length > 0) {\r\n            xhr.setRequestHeader(csrfTokenHeader, csrfToken);\r\n        }\r\n        xhr.onreadystatechange = () => {\r\n            if (xhr.readyState === 4) {\r\n                if (xhr.status === 200) {\r\n                    resolve(jsonParse(xhr.response));\r\n                }\r\n                else {\r\n                    reject(Error(xhr.statusText));\r\n                }\r\n            }\r\n        };\r\n        xhr.onerror = () => {\r\n            reject(Error('Network Error'));\r\n        };\r\n        xhr.send(uri);\r\n    });\r\n    return promise;\r\n}\r\n","export class CookieService {\r\n    /**\r\n     *\r\n     */\r\n    static getCookieStringValue(cookieName) {\r\n        cookieName = (cookieName || '').toLowerCase();\r\n        if (cookieName.length < 1) {\r\n            return undefined;\r\n        }\r\n        let cookies = (document.cookie || '').split(';').map(a => a.trim());\r\n        let cookieIndex = -1;\r\n        for (let i = 0; i < cookies.length; i++) {\r\n            let cookie = cookies[i];\r\n            let name = cookie.toLowerCase().slice(0, `${cookieName}=`.length);\r\n            let match = name === `${cookieName}=`;\r\n            if (match) {\r\n                cookieIndex = i;\r\n                break;\r\n            }\r\n        }\r\n        if (cookieIndex < 0) {\r\n            return undefined;\r\n        }\r\n        let rawCookie = cookies[cookieIndex];\r\n        let rawValue = rawCookie.slice(`${cookieName}=`.length) || '';\r\n        if (rawValue.length > 0) {\r\n            return decodeURIComponent(rawValue);\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    }\r\n}\r\n","import { AuthenticationService } from '../api-service/AuthenticationService';\r\nimport { ServiceTypes } from '../core/service-types';\r\nimport * as http from './http-service';\r\nimport { CookieService } from './cookie-service';\r\nexport class ApiService {\r\n    constructor(baseUrl, token = undefined) {\r\n        this._csrfTokenCookieName = 'cw-reqtkn';\r\n        this._csrfHeaderName = 'cw-csrf';\r\n        this._baseUrl = undefined;\r\n        this._csrfToken = undefined;\r\n        this._token = undefined;\r\n        if (typeof token === 'undefined' || !token || token.length < 1) {\r\n            this._token = undefined;\r\n        }\r\n        else {\r\n            this._token = token;\r\n        }\r\n        if (typeof baseUrl === 'undefined' || !baseUrl || baseUrl.length < 1) {\r\n            this._baseUrl = undefined;\r\n        }\r\n        else {\r\n            this._baseUrl = cleanUrl(baseUrl);\r\n        }\r\n    }\r\n    getToken() {\r\n        return this._token;\r\n    }\r\n    initializeCsrfToken() {\r\n        this._csrfToken = CookieService.getCookieStringValue(this._csrfTokenCookieName);\r\n    }\r\n    login(userName, password) {\r\n        if (this._baseUrl === null) {\r\n            return Promise.reject(\"No Cityworks URL is set. URL must be set in the constructor.\");\r\n        }\r\n        const request = {\r\n            LoginName: userName,\r\n            Password: password\r\n        };\r\n        const svc = new AuthenticationService(this);\r\n        const promise = svc.Authenticate(request);\r\n        promise.then((resp) => {\r\n            if (resp && resp.Status === ServiceTypes.CoreResponseStatus.Ok && resp.Value) {\r\n                this._token = resp.Value.Token;\r\n            }\r\n            else {\r\n                this._token = undefined;\r\n            }\r\n            return resp;\r\n        }, (response) => {\r\n            console.error(\"error logging in\");\r\n            console.error(response);\r\n            this._token = undefined;\r\n            return response;\r\n        });\r\n        return promise;\r\n    }\r\n    call(data, url) {\r\n        if (this._baseUrl === null) {\r\n            return Promise.reject(\"No Cityworks URL is set. URL must be set in the constructor.\");\r\n        }\r\n        return http.post(this._baseUrl + 'Services/' + url, this._token, this._csrfToken || undefined, this._csrfHeaderName, data);\r\n    }\r\n}\r\nfunction cleanUrl(u) {\r\n    const viewUrl = u[u.length - 1] === '/' || u[u.length - 1] == '\\\\' ? '' : (u.indexOf('/') > -1 ? '/' : '\\\\');\r\n    return u + viewUrl;\r\n}\r\n;\r\n"],"names":["http.post"],"mappings":"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"}